/*!
 * @license
 * luaparse 0.2.1 https://oxyc.github.io/luaparse/
 * Copyright 2012-2016 Oskar Schöldström <public@oxy.fi> (http://www.oxy.fi/)
 * MIT license
 */
!function(e,n,t){"use strict";var r={"function":!0,object:!0},a=r[typeof exports]&&exports&&!exports.nodeType&&exports,o=r[typeof module]&&module&&!module.nodeType&&module,u=a&&o&&"object"==typeof global&&global,i=o&&o.exports===a&&a;!u||u.global!==u&&u.window!==u&&u.self!==u||(e=u),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(define(["exports"],t),a&&i&&t(o.exports)):t(a&&o?i?o.exports:a:e[n]={})}(this,"luaparse",function(e){"use strict";function n(e){if(Je){var n=Qe.pop();n.complete(),Se.locations&&(e.loc=n.loc),Se.ranges&&(e.range=n.range)}return Se.onCreateNode&&Se.onCreateNode(e),e}function t(e,n,t){for(var r=0,a=e.length;a>r;r++)if(e[r][n]===t)return r;return-1}function r(e){var n=Ue.call(arguments,1);return e=e.replace(/%(\d)/g,function(e,t){return""+n[t-1]||""})}function a(){for(var e,n,t=Ue.call(arguments),r={},a=0,o=t.length;o>a;a++){e=t[a];for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n])}return r}function o(e){var n,t,a=r.apply(null,Ue.call(arguments,1));throw"undefined"!=typeof e.line?(t=e.range[0]-e.lineStart,n=new SyntaxError(r("[%1:%2] %3",e.line,t,a)),n.line=e.line,n.index=e.range[0],n.column=t):(t=Ke-Me+1,n=new SyntaxError(r("[%1:%2] %3",Ge,t,a)),n.index=Ke,n.line=Ge,n.column=t),n}function u(e,n){o(n,Re.expectedToken,e,n.value)}function i(e,n){if("undefined"==typeof n&&(n=De.value),"undefined"!=typeof e.type){var t;switch(e.type){case we:t="string";break;case ke:t="keyword";break;case Le:t="identifier";break;case Ne:t="number";break;case Oe:t="symbol";break;case Te:t="boolean";break;case Ie:return o(e,Re.unexpected,"symbol","nil",n)}return o(e,Re.unexpected,t,e.value,n)}return o(e,Re.unexpected,"symbol",e,n)}function c(){for(l();45===xe.charCodeAt(Ke)&&45===xe.charCodeAt(Ke+1);)x(),l();if(Ke>=Ce)return{type:Ee,value:"<eof>",line:Ge,lineStart:Me,range:[Ke,Ke]};var e=xe.charCodeAt(Ke),n=xe.charCodeAt(Ke+1);if(Pe=Ke,O(e))return f();switch(e){case 39:case 34:return h();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return v();case 46:return L(n)?v():46===n?46===xe.charCodeAt(Ke+2)?d():p(".."):p(".");case 61:return p(61===n?"==":"=");case 62:return p(61===n?">=":62===n?">>":">");case 60:return p(60===n?"<<":61===n?"<=":"<");case 126:return p(61===n?"~=":"~");case 58:return p(58===n?"::":":");case 91:return 91===n||61===n?m():p("[");case 47:return p(47===n?"//":"/");case 42:case 94:case 37:case 44:case 123:case 124:case 125:case 93:case 40:case 41:case 59:case 38:case 35:case 45:case 43:return p(xe.charAt(Ke))}return i(xe.charAt(Ke))}function s(){var e=xe.charCodeAt(Ke),n=xe.charCodeAt(Ke+1);return k(e)?(10===e&&13===n&&Ke++,13===e&&10===n&&Ke++,Ge++,Me=++Ke,!0):!1}function l(){for(;Ce>Ke;){var e=xe.charCodeAt(Ke);if(w(e))Ke++;else if(!s())break}}function f(){for(var e,n;T(xe.charCodeAt(++Ke)););return e=xe.slice(Pe,Ke),I(e)?n=ke:"true"===e||"false"===e?(n=Te,e="true"===e):"nil"===e?(n=Ie,e=null):n=Le,{type:n,value:e,line:Ge,lineStart:Me,range:[Pe,Ke]}}function p(e){return Ke+=e.length,{type:Oe,value:e,line:Ge,lineStart:Me,range:[Pe,Ke]}}function d(){return Ke+=3,{type:Ve,value:"...",line:Ge,lineStart:Me,range:[Pe,Ke]}}function h(){for(var e,n=xe.charCodeAt(Ke++),t=Ke,r="";Ce>Ke&&(e=xe.charCodeAt(Ke++),n!==e);)92===e?(r+=xe.slice(t,Ke-1)+g(),t=Ke):(Ke>=Ce||k(e))&&(r+=xe.slice(t,Ke-1),o({},Re.unfinishedString,r+String.fromCharCode(e)));return r+=xe.slice(t,Ke-1),{type:we,value:r,line:Ge,lineStart:Me,range:[Pe,Ke]}}function m(){var e=S();return!1===e&&o(je,Re.expected,"[",je.value),{type:we,value:e,line:Ge,lineStart:Me,range:[Pe,Ke]}}function v(){var e=xe.charAt(Ke),n=xe.charAt(Ke+1),t="0"===e&&"xX".indexOf(n||null)>=0?y():b();return{type:Ne,value:t,line:Ge,lineStart:Me,range:[Pe,Ke]}}function y(){var e,n,t,r,a=0,u=1,i=1;for(r=Ke+=2,N(xe.charCodeAt(Ke))||o({},Re.malformedNumber,xe.slice(Pe,Ke));N(xe.charCodeAt(Ke));)Ke++;if(e=parseInt(xe.slice(r,Ke),16),"."===xe.charAt(Ke)){for(n=++Ke;N(xe.charCodeAt(Ke));)Ke++;a=xe.slice(n,Ke),a=n===Ke?0:parseInt(a,16)/Math.pow(16,Ke-n)}if("pP".indexOf(xe.charAt(Ke)||null)>=0){for(Ke++,"+-".indexOf(xe.charAt(Ke)||null)>=0&&(i="+"===xe.charAt(Ke++)?1:-1),t=Ke,L(xe.charCodeAt(Ke))||o({},Re.malformedNumber,xe.slice(Pe,Ke));L(xe.charCodeAt(Ke));)Ke++;u=xe.slice(t,Ke),u=Math.pow(2,u*i)}return(e+a)*u}function b(){for(;L(xe.charCodeAt(Ke));)Ke++;if("."===xe.charAt(Ke))for(Ke++;L(xe.charCodeAt(Ke));)Ke++;if("eE".indexOf(xe.charAt(Ke)||null)>=0)for(Ke++,"+-".indexOf(xe.charAt(Ke)||null)>=0&&Ke++,L(xe.charCodeAt(Ke))||o({},Re.malformedNumber,xe.slice(Pe,Ke));L(xe.charCodeAt(Ke));)Ke++;return parseFloat(xe.slice(Pe,Ke))}function g(){var e=Ke;switch(xe.charAt(Ke)){case"n":return Ke++,"\n";case"r":return Ke++,"\r";case"t":return Ke++,"	";case"v":return Ke++,"\x0B";case"b":return Ke++,"\b";case"f":return Ke++,"\f";case"z":return Ke++,l(),"";case"x":return N(xe.charCodeAt(Ke+1))&&N(xe.charCodeAt(Ke+2))?(Ke+=3,"\\"+xe.slice(e,Ke)):"\\"+xe.charAt(Ke++);default:if(L(xe.charCodeAt(Ke))){for(;L(xe.charCodeAt(++Ke)););return"\\"+xe.slice(e,Ke)}return xe.charAt(Ke++)}}function x(){Pe=Ke,Ke+=2;var e=xe.charAt(Ke),n="",t=!1,r=Ke,a=Me,o=Ge;if("["===e&&(n=S(),!1===n?n=e:t=!0),!t){for(;Ce>Ke&&!k(xe.charCodeAt(Ke));)Ke++;Se.comments&&(n=xe.slice(r,Ke))}if(Se.comments){var u=ze.comment(n,xe.slice(Pe,Ke));Se.locations&&(u.loc={start:{line:o,column:Pe-a},end:{line:Ge,column:Ke-Me}}),Se.ranges&&(u.range=[Pe,Ke]),Se.onCreateNode&&Se.onCreateNode(u),Fe.push(u)}}function S(){var e,n,t=0,r="",a=!1;for(Ke++;"="===xe.charAt(Ke+t);)t++;if("["!==xe.charAt(Ke+t))return!1;for(Ke+=t+1,k(xe.charCodeAt(Ke))&&s(),n=Ke;Ce>Ke;){if(k(xe.charCodeAt(Ke))&&s(),e=xe.charAt(Ke++),"]"===e){a=!0;for(var o=0;t>o;o++)"="!==xe.charAt(Ke+o)&&(a=!1);"]"!==xe.charAt(Ke+t)&&(a=!1)}if(a)break}return r+=xe.slice(n,Ke-1),Ke+=t+1,r}function C(){Be=je,je=De,De=c()}function A(e){return e===je.value?(C(),!0):!1}function E(e){e===je.value?C():o(je,Re.expected,e,je.value)}function w(e){return 9===e||32===e||11===e||12===e}function k(e){return 10===e||13===e}function L(e){return e>=48&&57>=e}function N(e){return e>=48&&57>=e||e>=97&&102>=e||e>=65&&70>=e}function O(e){return e>=65&&90>=e||e>=97&&122>=e||95===e}function T(e){return e>=65&&90>=e||e>=97&&122>=e||95===e||e>=48&&57>=e}function I(e){switch(e.length){case 2:return"do"===e||"if"===e||"in"===e||"or"===e;case 3:return"and"===e||"end"===e||"for"===e||"not"===e;case 4:return"else"===e||"goto"===e||"then"===e;case 5:return"break"===e||"local"===e||"until"===e||"while"===e;case 6:return"elseif"===e||"repeat"===e||"return"===e;case 8:return"function"===e}return!1}function V(e){return Oe===e.type?"#-~".indexOf(e.value)>=0:ke===e.type?"not"===e.value:!1}function K(e){switch(e.type){case"CallExpression":case"TableCallExpression":case"StringCallExpression":return!0}return!1}function j(e){if(Ee===e.type)return!0;if(ke!==e.type)return!1;switch(e.value){case"else":case"elseif":case"end":case"until":return!0;default:return!1}}function B(){var e=Array.apply(null,Xe[qe++]);Xe.push(e),Se.onCreateScope&&Se.onCreateScope()}function D(){Xe.pop();qe--,Se.onDestroyScope&&Se.onDestroyScope()}function F(e){-1===We(Xe[qe],e)&&Xe[qe].push(e)}function P(e){F(e.name),G(e,!0)}function G(e,n){n||-1!==t(He,"name",e.name)||He.push(e),e.isLocal=n}function M(e){return-1!==We(Xe[qe],e)}function R(){return new z(je)}function z(e){Se.locations&&(this.loc={start:{line:e.line,column:e.range[0]-e.lineStart},end:{line:0,column:0}}),Se.ranges&&(this.range=[e.range[0],0])}function U(){Je&&Qe.push(R())}function W(e){Je&&Qe.push(e)}function X(){C(),U(),Se.scope&&B();var e=q();return Se.scope&&D(),Ee!==je.type&&i(je),Je&&!e.length&&(Be=je),n(ze.chunk(e))}function q(e){for(var n,t=[];!j(je);){if("return"===je.value){t.push(H());break}n=H(),n&&t.push(n)}return t}function H(){if(U(),ke===je.type)switch(je.value){case"local":return C(),re();case"if":return C(),ne();case"return":return C(),ee();case"function":C();var e=ce();return ie(e);case"while":return C(),$();case"for":return C(),te();case"repeat":return C(),_();case"break":return C(),Q();case"do":return C(),Z();case"goto":return C(),Y()}return Oe===je.type&&A("::")?J():(Je&&Qe.pop(),A(";")?void 0:oe())}function J(){var e=je.value,t=ue();return Se.scope&&(F("::"+e+"::"),G(t,!0)),E("::"),n(ze.labelStatement(t))}function Q(){return n(ze.breakStatement())}function Y(){var e=(je.value,ue());return n(ze.gotoStatement(e))}function Z(){Se.scope&&B();var e=q();return Se.scope&&D(),E("end"),n(ze.doStatement(e))}function $(){var e=fe();E("do"),Se.scope&&B();var t=q();return Se.scope&&D(),E("end"),n(ze.whileStatement(e,t))}function _(){Se.scope&&B();var e=q();E("until");var t=fe();return Se.scope&&D(),n(ze.repeatStatement(t,e))}function ee(){var e=[];if("end"!==je.value){var t=le();for(null!=t&&e.push(t);A(",");)t=fe(),e.push(t);A(";")}return n(ze.returnStatement(e))}function ne(){var e,t,r,a=[];for(Je&&(r=Qe[Qe.length-1],Qe.push(r)),e=fe(),E("then"),Se.scope&&B(),t=q(),Se.scope&&D(),a.push(n(ze.ifClause(e,t))),Je&&(r=R());A("elseif");)W(r),e=fe(),E("then"),Se.scope&&B(),t=q(),Se.scope&&D(),a.push(n(ze.elseifClause(e,t))),Je&&(r=R());return A("else")&&(Je&&(r=new z(Be),Qe.push(r)),Se.scope&&B(),t=q(),Se.scope&&D(),a.push(n(ze.elseClause(t)))),E("end"),n(ze.ifStatement(a))}function te(){var e,t=ue();if(Se.scope&&(B(),P(t)),A("=")){var r=fe();E(",");var a=fe(),o=A(",")?fe():null;return E("do"),e=q(),E("end"),Se.scope&&D(),n(ze.forNumericStatement(t,r,a,o,e))}for(var u=[t];A(",");)t=ue(),Se.scope&&P(t),u.push(t);E("in");var i=[];do{var c=fe();i.push(c)}while(A(","));return E("do"),e=q(),E("end"),Se.scope&&D(),n(ze.forGenericStatement(u,i,e))}function re(){var e;if(Le===je.type){var t=[],r=[];do e=ue(),t.push(e);while(A(","));if(A("="))do{var a=fe();r.push(a)}while(A(","));if(Se.scope)for(var o=0,i=t.length;i>o;o++)P(t[o]);return n(ze.localStatement(t,r))}return A("function")?(e=ue(),Se.scope&&(P(e),B()),ie(e,!0)):void u("<name>",je)}function ae(e){(e.inParens||-1===["Identifier","MemberExpression","IndexExpression"].indexOf(e.type))&&o(je,Re.invalidVar,je.value)}function oe(){var e,t,r=je;if(Je&&(t=R()),e=he(),null==e)return i(je);if(",=".indexOf(je.value)>=0){var a,o=[e],c=[];for(ae(e);A(",");)a=he(),null==a&&u("<expression>",je),ae(a),o.push(a);E("=");do a=fe(),c.push(a);while(A(","));return W(t),n(ze.assignmentStatement(o,c))}return K(e)?(W(t),n(ze.callStatement(e))):i(r)}function ue(){U();var e=je.value;return Le!==je.type&&u("<name>",je),C(),n(ze.identifier(e))}function ie(e,t){var r=[];if(E("("),!A(")"))for(;;)if(Le===je.type){var a=ue();if(Se.scope&&P(a),r.push(a),A(","))continue;if(A(")"))break}else{if(Ve===je.type){r.push(ve()),E(")");break}u("<name> or '...'",je)}var o=q();return E("end"),Se.scope&&D(),t=t||!1,n(ze.functionStatement(e,r,t,o))}function ce(){var e,t,r;for(Je&&(r=R()),e=ue(),Se.scope&&(G(e,M(e.name)),B());A(".");)W(r),t=ue(),e=n(ze.memberExpression(e,".",t));return A(":")&&(W(r),t=ue(),e=n(ze.memberExpression(e,":",t)),Se.scope&&F("self")),e}function se(){for(var e,t,r=[];;){if(U(),Oe===je.type&&A("["))e=fe(),E("]"),E("="),t=fe(),r.push(n(ze.tableKey(e,t)));else if(Le===je.type)"="===De.value?(e=ue(),C(),t=fe(),r.push(n(ze.tableKeyString(e,t)))):(t=fe(),r.push(n(ze.tableValue(t))));else{if(null==(t=le())){Qe.pop();break}r.push(n(ze.tableValue(t)))}if(!(",;".indexOf(je.value)>=0))break;C()}return E("}"),n(ze.tableConstructorExpression(r))}function le(){var e=de(0);return e}function fe(){var e=le();return null!=e?e:void u("<expression>",je)}function pe(e){var n=e.charCodeAt(0),t=e.length;if(1===t)switch(n){case 94:return 12;case 42:case 47:case 37:return 10;case 43:case 45:return 9;case 38:return 6;case 126:return 5;case 124:return 4;case 60:case 62:return 3}else if(2===t)switch(n){case 47:return 10;case 46:return 8;case 60:case 62:return"<<"===e||">>"===e?7:3;case 61:case 126:return 3;case 111:return 1}else if(97===n&&"and"===e)return 2;return 0}function de(e){var t,r,a=je.value;if(Je&&(r=R()),V(je)){U(),C();var o=de(10);null==o&&u("<expression>",je),t=n(ze.unaryExpression(a,o))}if(null==t&&(t=ve(),null==t&&(t=he())),null==t)return null;for(var i;;){if(a=je.value,i=Oe===je.type||ke===je.type?pe(a):0,0===i||e>=i)break;"^"!==a&&".."!==a||i--,C();var c=de(i);null==c&&u("<expression>",je),Je&&Qe.push(r),t=n(ze.binaryExpression(a,t,c))}return t}function he(){var e,t,r;if(Je&&(r=R()),Le===je.type)t=je.value,e=ue(),Se.scope&&G(e,M(t));else{if(!A("("))return null;e=fe(),E(")"),e.inParens=!0}for(var a,o;;)if(Oe===je.type)switch(je.value){case"[":W(r),C(),a=fe(),e=n(ze.indexExpression(e,a)),E("]");break;case".":W(r),C(),o=ue(),e=n(ze.memberExpression(e,".",o));break;case":":W(r),C(),o=ue(),e=n(ze.memberExpression(e,":",o)),W(r),e=me(e);break;case"(":case"{":W(r),e=me(e);break;default:return e}else{if(we!==je.type)break;W(r),e=me(e)}return e}function me(e){if(Oe===je.type)switch(je.value){case"(":C();var t=[],r=le();for(null!=r&&t.push(r);A(",");)r=fe(),t.push(r);return E(")"),n(ze.callExpression(e,t));case"{":U(),C();var a=se();return n(ze.tableCallExpression(e,a))}else if(we===je.type)return n(ze.stringCallExpression(e,ve()));u("function arguments",je)}function ve(){var e,t=we|Ne|Te|Ie|Ve,r=je.value,a=je.type;if(Je&&(e=R()),a&t){W(e);var o=xe.slice(je.range[0],je.range[1]);return C(),n(ze.literal(a,r,o))}return ke===a&&"function"===r?(W(e),C(),Se.scope&&B(),ie(null)):A("{")?(W(e),se()):void 0}function ye(n,t){return"undefined"==typeof t&&"object"==typeof n&&(t=n,n=void 0),t||(t={}),xe=n||"",Se=a(Ae,t),Ke=0,Ge=1,Me=0,Ce=xe.length,Xe=[[]],qe=0,He=[],Qe=[],Se.comments&&(Fe=[]),Se.wait?e:ge()}function be(n){return xe+=String(n),Ce=xe.length,e}function ge(e){"undefined"!=typeof e&&be(e),xe&&"#!"===xe.substr(0,2)&&(xe=xe.replace(/^.*/,function(e){return e.replace(/./g," ")})),Ce=xe.length,Je=Se.locations||Se.ranges,De=c();var n=X();if(Se.comments&&(n.comments=Fe),Se.scope&&(n.globals=He),Qe.length>0)throw new Error("Location tracking failed. This is most likely a bug in luaparse");return n}e.version="0.2.1";var xe,Se,Ce,Ae=e.defaultOptions={wait:!1,comments:!0,scope:!1,locations:!1,ranges:!1,onCreateNode:null,onCreateScope:null,onDestroyScope:null},Ee=1,we=2,ke=4,Le=8,Ne=16,Oe=32,Te=64,Ie=128,Ve=256;e.tokenTypes={EOF:Ee,StringLiteral:we,Keyword:ke,Identifier:Le,NumericLiteral:Ne,Punctuator:Oe,BooleanLiteral:Te,NilLiteral:Ie,VarargLiteral:Ve};var Ke,je,Be,De,Fe,Pe,Ge,Me,Re=e.errors={unexpected:"unexpected %1 '%2' near '%3'",expected:"'%1' expected near '%2'",expectedToken:"%1 expected near '%2'",unfinishedString:"unfinished string near '%1'",malformedNumber:"malformed number near '%1'",invalidVar:"invalid left-hand side of assignment near '%1'"},ze=e.ast={labelStatement:function(e){return{type:"LabelStatement",label:e}},breakStatement:function(){return{type:"BreakStatement"}},gotoStatement:function(e){return{type:"GotoStatement",label:e}},returnStatement:function(e){return{type:"ReturnStatement",arguments:e}},ifStatement:function(e){return{type:"IfStatement",clauses:e}},ifClause:function(e,n){return{type:"IfClause",condition:e,body:n}},elseifClause:function(e,n){return{type:"ElseifClause",condition:e,body:n}},elseClause:function(e){return{type:"ElseClause",body:e}},whileStatement:function(e,n){return{type:"WhileStatement",condition:e,body:n}},doStatement:function(e){return{type:"DoStatement",body:e}},repeatStatement:function(e,n){return{type:"RepeatStatement",condition:e,body:n}},localStatement:function(e,n){return{type:"LocalStatement",variables:e,init:n}},assignmentStatement:function(e,n){return{type:"AssignmentStatement",variables:e,init:n}},callStatement:function(e){return{type:"CallStatement",expression:e}},functionStatement:function(e,n,t,r){return{type:"FunctionDeclaration",identifier:e,isLocal:t,parameters:n,body:r}},forNumericStatement:function(e,n,t,r,a){return{type:"ForNumericStatement",variable:e,start:n,end:t,step:r,body:a}},forGenericStatement:function(e,n,t){return{type:"ForGenericStatement",variables:e,iterators:n,body:t}},chunk:function(e){return{type:"Chunk",body:e}},identifier:function(e){return{type:"Identifier",name:e}},literal:function(e,n,t){return e=e===we?"StringLiteral":e===Ne?"NumericLiteral":e===Te?"BooleanLiteral":e===Ie?"NilLiteral":"VarargLiteral",{type:e,value:n,raw:t}},tableKey:function(e,n){return{type:"TableKey",key:e,value:n}},tableKeyString:function(e,n){return{type:"TableKeyString",key:e,value:n}},tableValue:function(e){return{type:"TableValue",value:e}},tableConstructorExpression:function(e){return{type:"TableConstructorExpression",fields:e}},binaryExpression:function(e,n,t){var r="and"===e||"or"===e?"LogicalExpression":"BinaryExpression";return{type:r,operator:e,left:n,right:t}},unaryExpression:function(e,n){return{type:"UnaryExpression",operator:e,argument:n}},memberExpression:function(e,n,t){return{type:"MemberExpression",indexer:n,identifier:t,base:e}},indexExpression:function(e,n){return{type:"IndexExpression",base:e,index:n}},callExpression:function(e,n){return{type:"CallExpression",base:e,arguments:n}},tableCallExpression:function(e,n){return{type:"TableCallExpression",base:e,arguments:n}},stringCallExpression:function(e,n){return{type:"StringCallExpression",base:e,argument:n}},comment:function(e,n){return{type:"Comment",value:e,raw:n}}},Ue=Array.prototype.slice,We=(Object.prototype.toString,function(e,n){for(var t=0,r=e.length;r>t;t++)if(e[t]===n)return t;return-1});e.lex=c;var Xe,qe,He,Je,Qe=[];z.prototype.complete=function(){Se.locations&&(this.loc.end.line=Be.line,this.loc.end.column=Be.range[1]-Be.lineStart),Se.ranges&&(this.range[1]=Be.range[1])},e.parse=ye,e.write=be,e.end=ge});